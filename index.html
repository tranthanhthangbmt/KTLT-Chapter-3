<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr√¨nh ph√°t B√†i gi·∫£ng</title>
    
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 0; padding: 0; background-color: #000; overflow: hidden; }
        .player-container { background-color: #ffffff; width: 100vw; height: 100vh; padding: 10px; box-sizing: border-box; display: flex; flex-direction: column; }
        .slide-viewer { border: 1px solid #ddd; border-radius: 8px; overflow-y: auto; margin-bottom: 10px; flex-grow: 1; position: relative; }
        .slide-viewer img { width: 100%; height: auto; display: block; }
        .slide-viewer.fit-mode { overflow: hidden; }
        .slide-viewer.fit-mode img { width: 100%; height: 100%; object-fit: contain; }
        .timeline-container { width: 100%; padding: 5px 0; margin-bottom: 5px; }
        .progress-bar-wrapper { background-color: #e0e0e0; border-radius: 5px; cursor: pointer; padding: 4px 0; }
        .progress-bar { background-color: #007bff; width: 0%; height: 8px; border-radius: 5px; }
        .time-display { display: flex; justify-content: space-between; font-size: 12px; color: #666; margin-top: 5px; }
        .controls { display: flex; justify-content: space-around; align-items: center; gap: 5px; flex-shrink: 0; }
        
        /* [C·∫¨P NH·∫¨T] Style cho c√°c n√∫t d·∫°ng icon */
        .controls button {
            color: white; border: none; border-radius: 50%; /* Bo tr√≤n n√∫t */
            width: 44px; height: 44px; /* K√≠ch th∆∞·ªõc chu·∫©n cho mobile */
            font-size: 20px; /* K√≠ch th∆∞·ªõc icon */
            cursor: pointer; transition: background-color 0.3s;
            display: flex; align-items: center; justify-content: center;
            padding: 0;
        }
        
        #prev-btn, #next-btn { background-color: #007bff; }
        #play-pause-btn { background-color: #28a745; width: 50px; height: 50px; font-size: 24px; }
        #play-pause-btn.playing { background-color: #dc3545; }
        #scale-btn { background-color: #17a2b8; }
        #autoscroll-btn { background-color: #6c757d; }
        #autoscroll-btn.active { background-color: #fd7e14; }
        #fullscreen-btn { background-color: #6c757d; }
        .slide-counter { flex-grow: 1; text-align: center; font-size: 16px; color: #333; font-weight: bold; }
    </style>
</head>
<body>

    <div class="player-container">
        <div id="slide-viewer" class="slide-viewer">
            <img id="slide-image" src="" alt="N·ªôi dung slide">
        </div>
        <div class="timeline-container">
            <div id="progress-bar-wrapper" class="progress-bar-wrapper">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
            <div class="time-display">
                <span id="current-time">00:00</span>
                <span id="total-duration">00:00</span>
            </div>
        </div>
        <div class="controls">
            <button id="prev-btn" title="Slide tr∆∞·ªõc">‚è™</button>
            <button id="play-pause-btn" title="Ph√°t/D·ª´ng">‚ñ∂Ô∏è</button>
            <div id="slide-counter" class="slide-counter"></div>
            <button id="next-btn" title="Slide ti·∫øp theo">‚è©</button>
            <button id="autoscroll-btn" title="B·∫≠t/T·∫Øt T·ª± cu·ªôn">üîÑ</button>
            <button id="scale-btn" title="Ch·∫ø ƒë·ªô xem">‚õ∂</button>
            <button id="fullscreen-btn" title="To√†n m√†n h√¨nh">üñºÔ∏è</button>
        </div>
        <audio id="slide-audio" src=""></audio>
    </div>

    <script>
        // --- PH·∫¶N C·∫§U H√åNH ---
        const TOTAL_SLIDES = 39;
        const IMAGE_BASENAME = 'slide-';
        const IMAGE_EXTENSION = '.png';

        // --- PH·∫¶N LOGIC ---
        const slideViewer=document.getElementById("slide-viewer"),slideImage=document.getElementById("slide-image"),slideAudio=document.getElementById("slide-audio"),autoscrollBtn=document.getElementById("autoscroll-btn"),playPauseBtn=document.getElementById("play-pause-btn"),prevBtn=document.getElementById("prev-btn"),nextBtn=document.getElementById("next-btn"),slideCounter=document.getElementById("slide-counter"),scaleBtn=document.getElementById("scale-btn"),fullscreenBtn=document.getElementById("fullscreen-btn"),progressBarWrapper=document.getElementById("progress-bar-wrapper"),progressBar=document.getElementById("progress-bar"),currentTimeEl=document.getElementById("current-time"),totalDurationEl=document.getElementById("total-duration");
        let isFitMode=!1,scrollAnimationId=null,currentSlideIndex=0,isAutoscrollEnabled=!1;
        
        function showSlide(e){cancelAnimationFrame(scrollAnimationId);const t=slides[e];slideImage.src=t.image,slideAudio.src=t.audio,slideCounter.textContent=`${e+1} / ${TOTAL_SLIDES}`,slideViewer.scrollTop=0,prevBtn.disabled=0===e;const l=slideAudio.play();void 0!==l&&l.catch(e=>console.log("Autoplay b·ªã ch·∫∑n."))}
        function autoScroll(){if(!isAutoscrollEnabled||isFitMode||slideAudio.paused||slideAudio.ended)return;const e=slideAudio.duration,t=slideAudio.currentTime,l=slideViewer.scrollHeight-slideViewer.clientHeight,n=(t/e)*l;slideViewer.scrollTop=n,scrollAnimationId=requestAnimationFrame(autoScroll)}
        
        // [C·∫¨P NH·∫¨T] Logic n√∫t T·ª± cu·ªôn ch·ªâ ƒë·ªïi m√†u, kh√¥ng ƒë·ªïi text
        autoscrollBtn.addEventListener("click",()=>{isAutoscrollEnabled=!isAutoscrollEnabled,autoscrollBtn.classList.toggle("active",isAutoscrollEnabled),isAutoscrollEnabled&&!slideAudio.paused?requestAnimationFrame(autoScroll):cancelAnimationFrame(scrollAnimationId)});
        
        // [C·∫¨P NH·∫¨T] Logic n√∫t Scale gi·ªù ƒë·ªïi icon
        scaleBtn.addEventListener("click",()=>{isFitMode=!isFitMode,slideViewer.classList.toggle("fit-mode",isFitMode),scaleBtn.innerHTML=isFitMode?"‚ÜïÔ∏è":"‚õ∂",isFitMode?cancelAnimationFrame(scrollAnimationId):requestAnimationFrame(autoScroll)});

        // [C·∫¨P NH·∫¨T L·ªöN] H√†m Fullscreen gi·ªù c√≥ th·ªÉ xoay ngang m√†n h√¨nh tr√™n di ƒë·ªông
        function toggleFullscreen() {
            const isMobile = window.matchMedia("(max-width: 768px)").matches;
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    alert(`Kh√¥ng th·ªÉ b·∫≠t ch·∫ø ƒë·ªô to√†n m√†n h√¨nh: ${err.message}`);
                });
                // N·∫øu l√† mobile, y√™u c·∫ßu xoay ngang
                if (isMobile && screen.orientation && typeof screen.orientation.lock === 'function') {
                    screen.orientation.lock('landscape').catch(err => {
                        console.log("Kh√¥ng th·ªÉ t·ª± ƒë·ªông xoay m√†n h√¨nh.");
                    });
                }
            } else {
                // N·∫øu ƒëang fullscreen, tho√°t ra
                document.exitFullscreen();
                // M·ªü kh√≥a xoay m√†n h√¨nh
                if (isMobile && screen.orientation && typeof screen.orientation.unlock === 'function') {
                    screen.orientation.unlock();
                }
            }
        }
        
        fullscreenBtn.addEventListener("click", toggleFullscreen);
        document.addEventListener("fullscreenchange",()=>{
            const icon = document.fullscreenElement ? 'X' : 'üñºÔ∏è';
            fullscreenBtn.innerHTML = icon; // C·∫≠p nh·∫≠t icon
        });

        // C·∫≠p nh·∫≠t icon cho n√∫t Play/Pause
        slideAudio.addEventListener("play",()=>{playPauseBtn.innerHTML="‚è∏Ô∏è"});
        slideAudio.addEventListener("pause",()=>{playPauseBtn.innerHTML="‚ñ∂Ô∏è"});
        
        // C√°c h√†m v√† s·ª± ki·ªán kh√°c gi·ªØ nguy√™n (ƒë√£ ƒë∆∞·ª£c thu g·ªçn)
        function formatTime(e){const t=Math.floor(e/60),l=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`}
        slideAudio.addEventListener("timeupdate",()=>{if(slideAudio.duration){progressBar.style.width=`${slideAudio.currentTime/slideAudio.duration*100}%`;currentTimeEl.textContent=formatTime(slideAudio.currentTime)}});
        slideAudio.addEventListener("loadedmetadata",()=>{totalDurationEl.textContent=formatTime(slideAudio.duration)});
        progressBarWrapper.addEventListener("click",e=>{const t=slideAudio.duration;slideAudio.currentTime=e.offsetX/progressBarWrapper.clientWidth*t});
        slideAudio.addEventListener("ended",()=>{if(currentSlideIndex<slides.length-1){nextBtn.click()}});
        playPauseBtn.addEventListener("click",()=>{if(slideAudio.paused){slideAudio.play()}else{slideAudio.pause()}});
        prevBtn.addEventListener("click",()=>{if(currentSlideIndex>0){currentSlideIndex--,showSlide(currentSlideIndex)}});
        nextBtn.addEventListener("click",()=>{if(currentSlideIndex<slides.length-1){currentSlideIndex++,showSlide(currentSlideIndex)}});
        const slides=[];for(let i=1;i<=TOTAL_SLIDES;i++){slides.push({image:`images/slide-${i}.png`,audio:`audio/slide_${i}.mp3`})}
        window.onload=()=>{showSlide(currentSlideIndex)};
    </script>
</body>
</html>